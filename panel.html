<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DetectAds panel</title>

    <script src="jquery-3.2.1.min.js"></script>
    <script language="javascript" type="text/javascript">
     function init() {
       ws = new WebSocket('ws://localhost:8000/')
       ws.onopen = function(evt) {
       }
       ws.onclose = function(evt) {
       }
       ws.onmessage = onMessage
       ws.onerror = function(evt) {
         console.log(evt)
         ws.close()
       }
     }

     function start() {
       $('#inp').hide()
       $('#out').hide()
       $('#start').hide()
       sendJSON({'action': 'start',
                 'input': $('#inp').val(),
                 'output': $('#out').val()
       })
     }

     function onMessage(evt) {
       var d = JSON.parse(evt.data);
       if ('log' in d) {
         console.log(d.log)
       } else if ('scene' in d) {
         $('#scenes').prepend('<tr><td>' + d.scene + '</td><td>' + d.time + '</td><td><img src="' + d.preview + '"></td></tr>')
       }
     }

     function sendJSON(data) {
       ws.send(JSON.stringify(data))
     }
    </script>
  </head>

  <body onload="init()">
    <input id="inp" placeholder="Input" value="../spz240.mp4">
    <input id="out" placeholder="Output" value="out.mp4">
    <input type="button" id="start" onclick="start()" value="Start!">
    <table id="scenes" border="1">
    </table>
  </body>
</html>

